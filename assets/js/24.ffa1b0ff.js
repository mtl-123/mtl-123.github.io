(window.webpackJsonp=window.webpackJsonp||[]).push([[24],{378:function(t,s,a){"use strict";a.r(s);var e=a(8),r=Object(e.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h2",{attrs:{id:"✅-文档目标"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#✅-文档目标"}},[t._v("#")]),t._v(" ✅ 文档目标")]),t._v(" "),s("p",[t._v("帮助用户实现以下目标：")]),t._v(" "),s("ul",[s("li",[t._v("保持 WSL 在后台持续运行（即使关闭终端）")]),t._v(" "),s("li",[t._v("实现局域网访问 WSL 中的服务")]),t._v(" "),s("li",[t._v("确保配置逻辑清晰、操作可验证、流程完整")])]),t._v(" "),s("hr"),t._v(" "),s("h1",{attrs:{id:"📚-wsl-后台运行与网络访问配置手册"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#📚-wsl-后台运行与网络访问配置手册"}},[t._v("#")]),t._v(" 📚 WSL 后台运行与网络访问配置手册")]),t._v(" "),s("blockquote",[s("p",[t._v("💡 本文档旨在指导 Windows 用户配置 WSL2 子系统，实现服务后台常驻运行，并通过局域网访问其内部服务。")])]),t._v(" "),s("hr"),t._v(" "),s("h2",{attrs:{id:"第一章-需求背景"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#第一章-需求背景"}},[t._v("#")]),t._v(" 第一章：需求背景")]),t._v(" "),s("h3",{attrs:{id:"_1-1-问题描述"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-问题描述"}},[t._v("#")]),t._v(" 1.1 问题描述")]),t._v(" "),s("ul",[s("li",[t._v("WSL 默认在没有活动进程时会自动关闭")]),t._v(" "),s("li",[t._v("导致 SSH、Web 服务等无法长期运行")]),t._v(" "),s("li",[t._v("局域网设备无法直接访问 WSL 中的服务")])]),t._v(" "),s("h3",{attrs:{id:"_1-2-需求目标"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-需求目标"}},[t._v("#")]),t._v(" 1.2 需求目标")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("目标")]),t._v(" "),s("th",[t._v("描述")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("✅ 持续运行")]),t._v(" "),s("td",[t._v("即使关闭终端，WSL 仍持续运行")])]),t._v(" "),s("tr",[s("td",[t._v("✅ 本地访问")]),t._v(" "),s("td",[t._v("宿主机可以通过 IP + 端口访问服务")])]),t._v(" "),s("tr",[s("td",[t._v("✅ 局域网访问")]),t._v(" "),s("td",[t._v("同一局域网的其他设备也能访问该服务")])])])]),t._v(" "),s("hr"),t._v(" "),s("h2",{attrs:{id:"第二章-实现原理"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#第二章-实现原理"}},[t._v("#")]),t._v(" 第二章：实现原理")]),t._v(" "),s("h3",{attrs:{id:"_2-1-wsl-运行机制"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-wsl-运行机制"}},[t._v("#")]),t._v(" 2.1 WSL 运行机制")]),t._v(" "),s("ul",[s("li",[t._v("WSL2 是一个基于 Hyper-V 的轻量级虚拟机")]),t._v(" "),s("li",[t._v("当没有活跃进程时，整个 Linux 子系统会被终止（相当于关机）")])]),t._v(" "),s("h3",{attrs:{id:"_2-2-网络架构"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-网络架构"}},[t._v("#")]),t._v(" 2.2 网络架构")]),t._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("[局域网设备] —— (TCP/IP) —— [Windows 宿主机] —— (NAT) —— [WSL2 子系统]\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("ul",[s("li",[t._v("WSL2 有私有 IP（如 "),s("code",[t._v("172.x.x.x")]),t._v("）")]),t._v(" "),s("li",[t._v("Windows 宿主机作为 NAT 网关")]),t._v(" "),s("li",[t._v("外部访问需要借助 Port Proxy 和防火墙规则")])]),t._v(" "),s("hr"),t._v(" "),s("h2",{attrs:{id:"第三章-解决方案概述"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#第三章-解决方案概述"}},[t._v("#")]),t._v(" 第三章：解决方案概述")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("模块")]),t._v(" "),s("th",[t._v("解决方案")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("后台运行")]),t._v(" "),s("td",[t._v("使用 "),s("code",[t._v(".vbs")]),t._v(" 脚本开机启动 WSL 终端进程")])]),t._v(" "),s("tr",[s("td",[t._v("本地访问")]),t._v(" "),s("td",[t._v("使用 "),s("code",[t._v("netsh interface portproxy")]),t._v(" 映射端口")])]),t._v(" "),s("tr",[s("td",[t._v("局域网访问")]),t._v(" "),s("td",[t._v("添加防火墙入站规则允许外部访问")])])])]),t._v(" "),s("hr"),t._v(" "),s("h2",{attrs:{id:"第四章-详细配置步骤"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#第四章-详细配置步骤"}},[t._v("#")]),t._v(" 第四章：详细配置步骤")]),t._v(" "),s("hr"),t._v(" "),s("h3",{attrs:{id:"_4-1-持续运行-wsl-后台常驻"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-1-持续运行-wsl-后台常驻"}},[t._v("#")]),t._v(" 4.1 持续运行 WSL（后台常驻）")]),t._v(" "),s("h4",{attrs:{id:"_4-1-1-创建后台脚本文件"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-1-1-创建后台脚本文件"}},[t._v("#")]),t._v(" 4.1.1 创建后台脚本文件")]),t._v(" "),s("p",[t._v("文件名："),s("code",[t._v("start-wsl-background.vbs")])]),t._v(" "),s("div",{staticClass:"language-vbs line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v('Set objShell = CreateObject("WScript.Shell")\nobjShell.Run "cmd /c wsl", 0, False\n')])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br")])]),s("p",[t._v("📌 "),s("strong",[t._v("说明：")])]),t._v(" "),s("ul",[s("li",[s("code",[t._v("cmd /c wsl")]),t._v("：执行一次 "),s("code",[t._v("wsl")]),t._v(" 命令，进入默认发行版")]),t._v(" "),s("li",[s("code",[t._v("0")]),t._v("：表示窗口隐藏运行")]),t._v(" "),s("li",[s("code",[t._v("False")]),t._v("：不等待脚本执行完成")])]),t._v(" "),s("h4",{attrs:{id:"_4-1-2-设置开机自启动"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-1-2-设置开机自启动"}},[t._v("#")]),t._v(" 4.1.2 设置开机自启动")]),t._v(" "),s("ol",[s("li",[t._v("按下 "),s("code",[t._v("Win + R")]),t._v(" 输入 "),s("code",[t._v("shell:startup")]),t._v(" 打开“启动”文件夹")]),t._v(" "),s("li",[t._v("将上述 "),s("code",[t._v(".vbs")]),t._v(" 文件复制到该文件夹中")])]),t._v(" "),s("p",[t._v("✅ "),s("strong",[t._v("效果：")])]),t._v(" "),s("ul",[s("li",[t._v("Windows 开机后自动静默运行 WSL")]),t._v(" "),s("li",[t._v("即使关闭终端，WSL 也不会退出")])]),t._v(" "),s("hr"),t._v(" "),s("h3",{attrs:{id:"_4-2-获取-wsl-的-ip-地址"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-获取-wsl-的-ip-地址"}},[t._v("#")]),t._v(" 4.2 获取 WSL 的 IP 地址")]),t._v(" "),s("p",[t._v("在 WSL 中执行：")]),t._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("hostname")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-I")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("p",[t._v("输出示例：")]),t._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("172.27.250.42\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("p",[t._v("📌 "),s("strong",[t._v("用途：")])]),t._v(" "),s("ul",[s("li",[t._v("用于后续配置端口转发的目标地址")])]),t._v(" "),s("hr"),t._v(" "),s("h3",{attrs:{id:"_4-3-配置端口转发-port-proxy"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-3-配置端口转发-port-proxy"}},[t._v("#")]),t._v(" 4.3 配置端口转发（Port Proxy）")]),t._v(" "),s("h4",{attrs:{id:"_4-3-1-检查宿主机端口是否被占用"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-3-1-检查宿主机端口是否被占用"}},[t._v("#")]),t._v(" 4.3.1 检查宿主机端口是否被占用")]),t._v(" "),s("div",{staticClass:"language-powershell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-powershell"}},[s("code",[t._v("netstat "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("ano "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" findstr :8000\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("p",[t._v("如果输出为空，则端口可用；否则更换端口号。")]),t._v(" "),s("h4",{attrs:{id:"_4-3-2-添加-port-proxy-规则"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-3-2-添加-port-proxy-规则"}},[t._v("#")]),t._v(" 4.3.2 添加 Port Proxy 规则")]),t._v(" "),s("div",{staticClass:"language-powershell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-powershell"}},[s("code",[t._v("netsh interface portproxy add v4tov4 listenaddress=0"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("0"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("0"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("0 listenport=8000 connectaddress=172"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("27"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("250"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("42 connectport=8000\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("p",[t._v("📌 "),s("strong",[t._v("参数说明：")])]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("参数")]),t._v(" "),s("th",[t._v("含义")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[s("code",[t._v("listenaddress")])]),t._v(" "),s("td",[t._v("宿主机监听地址（0.0.0.0 表示所有接口）")])]),t._v(" "),s("tr",[s("td",[s("code",[t._v("listenport")])]),t._v(" "),s("td",[t._v("宿主机对外暴露的端口")])]),t._v(" "),s("tr",[s("td",[s("code",[t._v("connectaddress")])]),t._v(" "),s("td",[t._v("WSL 子系统的 IP 地址")])]),t._v(" "),s("tr",[s("td",[s("code",[t._v("connectport")])]),t._v(" "),s("td",[t._v("WSL 子系统中的服务端口")])])])]),t._v(" "),s("h4",{attrs:{id:"_4-3-3-查看当前-port-proxy-规则"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-3-3-查看当前-port-proxy-规则"}},[t._v("#")]),t._v(" 4.3.3 查看当前 Port Proxy 规则")]),t._v(" "),s("div",{staticClass:"language-powershell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-powershell"}},[s("code",[t._v("netsh interface portproxy show all\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("hr"),t._v(" "),s("h3",{attrs:{id:"_4-4-允许外部访问-添加防火墙规则"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-4-允许外部访问-添加防火墙规则"}},[t._v("#")]),t._v(" 4.4 允许外部访问（添加防火墙规则）")]),t._v(" "),s("p",[t._v("管理员身份打开 PowerShell 并执行：")]),t._v(" "),s("div",{staticClass:"language-powershell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-powershell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("New-NetFirewallRule")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("DisplayName "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Allow TCP Port 8000"')]),t._v(" `\n    "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Direction Inbound "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Protocol TCP "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("LocalPort 8000 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Action Allow "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Profile Any\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br")])]),s("p",[t._v("📌 "),s("strong",[t._v("作用：")])]),t._v(" "),s("ul",[s("li",[t._v("允许外部设备通过 TCP 协议访问本机的 "),s("code",[t._v("8000")]),t._v(" 端口")]),t._v(" "),s("li",[t._v("对应于局域网内设备访问宿主机的 IP + 端口")])]),t._v(" "),s("hr"),t._v(" "),s("h3",{attrs:{id:"_4-5-自动化脚本模板-推荐"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-5-自动化脚本模板-推荐"}},[t._v("#")]),t._v(" 4.5 自动化脚本模板（推荐）")]),t._v(" "),s("h4",{attrs:{id:"示例脚本-setup-portproxy-ps1"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#示例脚本-setup-portproxy-ps1"}},[t._v("#")]),t._v(" 示例脚本："),s("code",[t._v("setup-portproxy.ps1")])]),t._v(" "),s("div",{staticClass:"language-powershell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-powershell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 设置转发端口（请根据需要修改）")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$ListenPort")]),t._v(" = 8000\n"),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$ConnectIP")]),t._v(" = "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"172.27.250.42"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$ConnectPort")]),t._v(" = 8000\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 添加 Port Proxy 规则")]),t._v("\nnetsh interface portproxy add v4tov4 `\n    listenaddress=0"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("0"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("0"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("0 `\n    listenport="),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$ListenPort")]),t._v(" `\n    connectaddress="),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$ConnectIP")]),t._v(" `\n    connectport="),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$ConnectPort")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 添加防火墙入站规则")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("New-NetFirewallRule")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("DisplayName "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Allow TCP Port '),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$ListenPort")]),t._v('"')]),t._v(" `\n    "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Protocol TCP "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("LocalPort "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$ListenPort")]),t._v(" `\n    "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Action Allow "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Profile Any\n\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Write-Host")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"✅ 已添加 Port Proxy 和防火墙规则，端口: '),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$ListenPort")]),t._v('"')]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br"),s("span",{staticClass:"line-number"},[t._v("13")]),s("br"),s("span",{staticClass:"line-number"},[t._v("14")]),s("br"),s("span",{staticClass:"line-number"},[t._v("15")]),s("br"),s("span",{staticClass:"line-number"},[t._v("16")]),s("br"),s("span",{staticClass:"line-number"},[t._v("17")]),s("br"),s("span",{staticClass:"line-number"},[t._v("18")]),s("br")])]),s("p",[t._v("📌 "),s("strong",[t._v("使用方式：")])]),t._v(" "),s("ul",[s("li",[t._v("右键 → “以管理员身份运行”")])]),t._v(" "),s("hr"),t._v(" "),s("h3",{attrs:{id:"_4-6-设置脚本开机自启-可选但推荐"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-6-设置脚本开机自启-可选但推荐"}},[t._v("#")]),t._v(" 4.6 设置脚本开机自启（可选但推荐）")]),t._v(" "),s("ol",[s("li",[t._v("按下 "),s("code",[t._v("Win + R")]),t._v(" 输入 "),s("code",[t._v("shell:startup")]),t._v(" 打开“启动”文件夹")]),t._v(" "),s("li",[t._v("创建快捷方式指向你的 "),s("code",[t._v(".ps1")]),t._v(" 脚本，例如：")])]),t._v(" "),s("div",{staticClass:"language-text line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v('PowerShell.exe -ExecutionPolicy Bypass -File "C:\\scripts\\setup-portproxy.ps1"\n')])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("p",[t._v("📌 "),s("strong",[t._v("注意：")])]),t._v(" "),s("ul",[s("li",[t._v("确保路径正确")]),t._v(" "),s("li",[t._v("首次运行前建议测试脚本是否正常工作")])]),t._v(" "),s("hr"),t._v(" "),s("h2",{attrs:{id:"第五章-验证服务是否可达"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#第五章-验证服务是否可达"}},[t._v("#")]),t._v(" 第五章：验证服务是否可达")]),t._v(" "),s("h3",{attrs:{id:"_5-1-在宿主机上测试本地访问"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_5-1-在宿主机上测试本地访问"}},[t._v("#")]),t._v(" 5.1 在宿主机上测试本地访问")]),t._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("telnet "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("127.0")]),t._v(".0.1 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8000")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("h3",{attrs:{id:"_5-2-在局域网设备上测试访问"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_5-2-在局域网设备上测试访问"}},[t._v("#")]),t._v(" 5.2 在局域网设备上测试访问")]),t._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("telnet "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("宿主机IP"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8000")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("p",[t._v("例如：")]),t._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("telnet "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("192.168")]),t._v(".1.100 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8000")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("p",[t._v("✅ "),s("strong",[t._v("预期结果：")])]),t._v(" "),s("ul",[s("li",[t._v("成功连接并看到 HTTP 服务响应或文件列表")])]),t._v(" "),s("hr"),t._v(" "),s("h2",{attrs:{id:"附录-a-常用命令汇总"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#附录-a-常用命令汇总"}},[t._v("#")]),t._v(" 附录 A：常用命令汇总")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("操作")]),t._v(" "),s("th",[t._v("命令")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("获取 WSL IP 地址")]),t._v(" "),s("td",[s("code",[t._v("hostname -I")])])]),t._v(" "),s("tr",[s("td",[t._v("添加 Port Proxy 规则")]),t._v(" "),s("td",[s("code",[t._v("netsh interface portproxy add ...")])])]),t._v(" "),s("tr",[s("td",[t._v("查看 Port Proxy 列表")]),t._v(" "),s("td",[s("code",[t._v("netsh interface portproxy show all")])])]),t._v(" "),s("tr",[s("td",[t._v("删除 Port Proxy 规则")]),t._v(" "),s("td",[s("code",[t._v("netsh interface portproxy delete ...")])])]),t._v(" "),s("tr",[s("td",[t._v("添加防火墙规则")]),t._v(" "),s("td",[s("code",[t._v("New-NetFirewallRule ...")])])]),t._v(" "),s("tr",[s("td",[t._v("查看端口占用情况")]),t._v(" "),s("td",[s("code",[t._v("netstat -ano \\| findstr :<Port>")])])]),t._v(" "),s("tr",[s("td",[t._v("查看进程 ID 对应程序")]),t._v(" "),s("td",[s("code",[t._v("tasklist \\| findstr <PID>")])])]),t._v(" "),s("tr",[s("td",[t._v("测试本地访问")]),t._v(" "),s("td",[s("code",[t._v("telnet 127.0.0.1 <Port>")])])]),t._v(" "),s("tr",[s("td",[t._v("测试局域网访问")]),t._v(" "),s("td",[s("code",[t._v("telnet <宿主机IP> <Port>")])])])])]),t._v(" "),s("hr"),t._v(" "),s("h2",{attrs:{id:"附录-b-完整脚本模板下载"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#附录-b-完整脚本模板下载"}},[t._v("#")]),t._v(" 附录 B：完整脚本模板下载")]),t._v(" "),s("p",[t._v("你可以将以下内容分别保存为：")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("start-wsl-background.vbs")]),t._v("：用于开机自动运行 WSL")]),t._v(" "),s("li",[s("code",[t._v("setup-portproxy.ps1")]),t._v("：用于配置多个端口转发规则")])]),t._v(" "),s("h3",{attrs:{id:"✅-start-wsl-background-vbs"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#✅-start-wsl-background-vbs"}},[t._v("#")]),t._v(" ✅ "),s("code",[t._v("start-wsl-background.vbs")])]),t._v(" "),s("div",{staticClass:"language-vbs line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v('Set objShell = CreateObject("WScript.Shell")\nobjShell.Run "cmd /c wsl", 0, False\n')])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br")])]),s("h3",{attrs:{id:"✅-setup-portproxy-ps1"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#✅-setup-portproxy-ps1"}},[t._v("#")]),t._v(" ✅ "),s("code",[t._v("setup-portproxy.ps1")])]),t._v(" "),s("div",{staticClass:"language-powershell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-powershell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 添加多个端口转发规则")]),t._v("\nnetsh interface portproxy add v4tov4 listenaddress=0"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("0"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("0"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("0 listenport=80    connectaddress=172"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("27"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("250"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("42 connectport=80\nnetsh interface portproxy add v4tov4 listenaddress=0"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("0"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("0"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("0 listenport=22    connectaddress=172"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("27"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("250"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("42 connectport=22\nnetsh interface portproxy add v4tov4 listenaddress=0"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("0"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("0"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("0 listenport=3306  connectaddress=172"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("27"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("250"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("42 connectport=3306\nnetsh interface portproxy add v4tov4 listenaddress=0"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("0"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("0"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("0 listenport=8080  connectaddress=172"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("27"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("250"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("42 connectport=8080\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br")])]),s("hr")])}),[],!1,null,null,null);s.default=r.exports}}]);