(window.webpackJsonp=window.webpackJsonp||[]).push([[24],{378:function(s,a,t){"use strict";t.r(a);var e=t(8),r=Object(e.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"⚙️-wsl-后台运行与网络访问配置指南"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#⚙️-wsl-后台运行与网络访问配置指南"}},[s._v("#")]),s._v(" ⚙️ WSL 后台运行与网络访问配置指南")]),s._v(" "),a("blockquote",[a("p",[s._v("💡 本文档讲解如何让 WSL 在后台持续运行，并实现从局域网访问 WSL 内部服务。")])]),s._v(" "),a("hr"),s._v(" "),a("h2",{attrs:{id:"⏳-7-保持-wsl-在后台持续运行"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#⏳-7-保持-wsl-在后台持续运行"}},[s._v("#")]),s._v(" ⏳ 7. 保持 WSL 在后台持续运行")]),s._v(" "),a("blockquote",[a("p",[s._v("💡 当退出终端后，WSL 可能会自动关闭，导致 SSH 或其他服务中断。")])]),s._v(" "),a("h3",{attrs:{id:"解决方案-创建-vbs-脚本开机启动-wsl-并保持运行"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#解决方案-创建-vbs-脚本开机启动-wsl-并保持运行"}},[s._v("#")]),s._v(" 解决方案：创建 "),a("code",[s._v(".vbs")]),s._v(" 脚本开机启动 WSL 并保持运行")]),s._v(" "),a("h4",{attrs:{id:"_1-创建脚本文件-start-wsl-background-vbs"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-创建脚本文件-start-wsl-background-vbs"}},[s._v("#")]),s._v(" 1. 创建脚本文件 "),a("code",[s._v("start-wsl-background.vbs")])]),s._v(" "),a("div",{staticClass:"language-vbs line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('Set objShell = CreateObject("WScript.Shell")\nobjShell.Run "cmd /c wsl", 0, False\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("h4",{attrs:{id:"_2-设置开机自启动"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-设置开机自启动"}},[s._v("#")]),s._v(" 2. 设置开机自启动")]),s._v(" "),a("ul",[a("li",[s._v("按下 "),a("code",[s._v("Win + R")]),s._v(" 输入 "),a("code",[s._v("shell:startup")]),s._v(" 打开“启动”文件夹")]),s._v(" "),a("li",[s._v("将上述 "),a("code",[s._v(".vbs")]),s._v(" 文件复制到该文件夹中")])]),s._v(" "),a("p",[s._v("✅ 效果：")]),s._v(" "),a("ul",[a("li",[s._v("Windows 开机后自动静默运行 WSL")]),s._v(" "),a("li",[s._v("即使关闭终端，WSL 也不会退出")])]),s._v(" "),a("hr"),s._v(" "),a("h2",{attrs:{id:"🌐-8-让宿主机及局域网访问-wsl-中的服务"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#🌐-8-让宿主机及局域网访问-wsl-中的服务"}},[s._v("#")]),s._v(" 🌐 8. 让宿主机及局域网访问 WSL 中的服务")]),s._v(" "),a("blockquote",[a("p",[s._v("💡 示例：你在 WSL 中运行了一个 Python HTTP 服务监听在 "),a("code",[s._v("8000")]),s._v(" 端口，如何让局域网访问？")])]),s._v(" "),a("h3",{attrs:{id:"_1-在-wsl-中启动服务"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-在-wsl-中启动服务"}},[s._v("#")]),s._v(" 1. 在 WSL 中启动服务")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("nohup")]),s._v(" python3 "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-m")]),s._v(" http.server "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8000")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h3",{attrs:{id:"_2-获取-wsl-的-ip-地址"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-获取-wsl-的-ip-地址"}},[s._v("#")]),s._v(" 2. 获取 WSL 的 IP 地址")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("hostname")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-I")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("假设输出为："),a("code",[s._v("172.27.250.42")])]),s._v(" "),a("hr"),s._v(" "),a("h2",{attrs:{id:"🔁-9-配置-windows-端口转发-port-proxy"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#🔁-9-配置-windows-端口转发-port-proxy"}},[s._v("#")]),s._v(" 🔁 9. 配置 Windows 端口转发（Port Proxy）")]),s._v(" "),a("h3",{attrs:{id:"_1-获取-wsl-网卡名称"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-获取-wsl-网卡名称"}},[s._v("#")]),s._v(" 1. 获取 WSL 网卡名称")]),s._v(" "),a("p",[s._v("在 PowerShell 中执行：")]),s._v(" "),a("div",{staticClass:"language-powershell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[s._v("ipconfig "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("all\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("找到类似如下信息：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("以太网适配器 vEthernet (WSL (Hyper-V firewall)):\n\n   IPv4 地址 . . . . . . . . . . . . : 172.27.240.1(首选)\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("h3",{attrs:{id:"_2-添加防火墙规则允许访问"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-添加防火墙规则允许访问"}},[s._v("#")]),s._v(" 2. 添加防火墙规则允许访问")]),s._v(" "),a("p",[s._v("管理员身份打开 PowerShell 并执行：")]),s._v(" "),a("div",{staticClass:"language-powershell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("New-NetFirewallRule")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("DisplayName "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"WSL"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("Direction Inbound "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("InterfaceAlias "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"vEthernet (WSL (Hyper-V firewall))"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("Action Allow\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h3",{attrs:{id:"_3-配置端口转发-port-proxy"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-配置端口转发-port-proxy"}},[s._v("#")]),s._v(" 3. 配置端口转发（Port Proxy）")]),s._v(" "),a("div",{staticClass:"language-powershell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[s._v("netsh interface portproxy add v4tov4 listenaddress=0"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("0"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("0"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("0 listenport=8000 connectaddress=172"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("27"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("250"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("42 connectport=8000\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("hr"),s._v(" "),a("h2",{attrs:{id:"✅-10-验证服务是否可达"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#✅-10-验证服务是否可达"}},[s._v("#")]),s._v(" ✅ 10. 验证服务是否可达")]),s._v(" "),a("h3",{attrs:{id:"在宿主机上测试本地访问"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#在宿主机上测试本地访问"}},[s._v("#")]),s._v(" 在宿主机上测试本地访问")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("telnet "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8000")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h3",{attrs:{id:"在局域网设备上测试访问"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#在局域网设备上测试访问"}},[s._v("#")]),s._v(" 在局域网设备上测试访问")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("telnet "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("Windows宿主机IP"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8000")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("例如：")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("telnet "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".10.10 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8000")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("如果连接成功，说明服务已开放！")]),s._v(" "),a("hr"),s._v(" "),a("h2",{attrs:{id:"📎-附录-常用命令汇总"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#📎-附录-常用命令汇总"}},[s._v("#")]),s._v(" 📎 附录：常用命令汇总")]),s._v(" "),a("table",[a("thead",[a("tr",[a("th",[s._v("操作")]),s._v(" "),a("th",[s._v("命令")])])]),s._v(" "),a("tbody",[a("tr",[a("td",[s._v("获取 WSL IP")]),s._v(" "),a("td",[a("code",[s._v("hostname -I")])])]),s._v(" "),a("tr",[a("td",[s._v("添加防火墙规则")]),s._v(" "),a("td",[a("code",[s._v('New-NetFirewallRule -DisplayName "WSL" -Direction Inbound ...')])])]),s._v(" "),a("tr",[a("td",[s._v("配置端口转发")]),s._v(" "),a("td",[a("code",[s._v("netsh interface portproxy add v4tov4 ...")])])]),s._v(" "),a("tr",[a("td",[s._v("测试端口连通性")]),s._v(" "),a("td",[a("code",[s._v("telnet <IP> <Port>")])])])])]),s._v(" "),a("hr")])}),[],!1,null,null,null);a.default=r.exports}}]);