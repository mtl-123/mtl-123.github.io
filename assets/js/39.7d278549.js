(window.webpackJsonp=window.webpackJsonp||[]).push([[39],{395:function(s,a,t){"use strict";t.r(a);var e=t(8),r=Object(e.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("blockquote",[a("p",[s._v("Docker存储空间不足，需要迁移数据到新的存储路径以解决空间不足的问题。")])]),s._v(" "),a("h3",{attrs:{id:"_1-停止docker服务"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-停止docker服务"}},[s._v("#")]),s._v(" 1. 停止Docker服务")]),s._v(" "),a("p",[s._v("首先，停止Docker服务以确保数据的一致性和完整性。")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" systemctl stop "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h3",{attrs:{id:"_2-创建新的存储路径"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-创建新的存储路径"}},[s._v("#")]),s._v(" 2. 创建新的存储路径")]),s._v(" "),a("p",[s._v("创建一个新的目录作为Docker的新默认存储路径，并确保Docker有写入权限。")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" /new/docker/storage\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("chown")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-R")]),s._v(" root:root /new/docker/storage\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("chmod")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-R")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("711")]),s._v(" /new/docker/storage\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("h3",{attrs:{id:"_3-迁移现有数据"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-迁移现有数据"}},[s._v("#")]),s._v(" 3. 迁移现有数据")]),s._v(" "),a("p",[s._v("使用"),a("code",[s._v("rsync")]),s._v("工具将现有的Docker数据从旧的存储路径迁移到新的存储路径。确保Docker服务已经停止，以避免数据不一致。")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("rsync")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-aqxP")]),s._v(" /var/lib/docker/ /new/docker/storage/\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h3",{attrs:{id:"_4-修改docker配置文件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-修改docker配置文件"}},[s._v("#")]),s._v(" 4. 修改Docker配置文件")]),s._v(" "),a("p",[s._v("编辑Docker的配置文件，通常是"),a("code",[s._v("/etc/docker/daemon.json")]),s._v("。如果没有这个文件，可以创建它。")]),s._v(" "),a("p",[s._v("打开或创建"),a("code",[s._v("daemon.json")]),s._v("文件：")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v(" /etc/docker/daemon.json\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("添加或修改如下配置：")]),s._v(" "),a("div",{staticClass:"language-json line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"registry-mirrors"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"https://docker.hpcloud.cloud"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"https://docker.m.daocloud.io"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"https://docker.unsee.tech"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"https://docker.1panel.live"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"http://mirrors.ustc.edu.cn"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"https://docker.chenby.cn"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"http://mirror.azure.cn"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"https://dockerpull.org"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"https://dockerhub.icu"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"https://hub.rat.dev"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"https://proxy.1panel.live"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"https://docker.1panel.top"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"https://docker.m.daocloud.io"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"https://docker.1ms.run"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"https://docker.ketches.cn"')]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"data-root"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/new/docker/storage"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br")])]),a("p",[s._v("保存并关闭文件。")]),s._v(" "),a("h3",{attrs:{id:"_5-重启docker服务"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-重启docker服务"}},[s._v("#")]),s._v(" 5. 重启Docker服务")]),s._v(" "),a("p",[s._v("应用新的配置后，重新启动Docker服务。")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" systemctl start "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h3",{attrs:{id:"_6-验证更改"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-验证更改"}},[s._v("#")]),s._v(" 6. 验证更改")]),s._v(" "),a("p",[s._v("验证Docker是否已使用新的存储路径。可以通过查看Docker信息来确认：")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" info "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Docker Root Dir'")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("你应该会看到输出类似于：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("Docker Root Dir: /new/docker/storage\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h3",{attrs:{id:"_7-检查镜像"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_7-检查镜像"}},[s._v("#")]),s._v(" 7. 检查镜像")]),s._v(" "),a("p",[s._v("确保Docker能够看到迁移前的镜像。")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" images\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h3",{attrs:{id:"_8-检查容器"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_8-检查容器"}},[s._v("#")]),s._v(" 8. 检查容器")]),s._v(" "),a("p",[s._v("确保Docker能够看到迁移前的容器。")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ps")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-a")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h3",{attrs:{id:"_9-重新启动容器"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_9-重新启动容器"}},[s._v("#")]),s._v(" 9. 重新启动容器")]),s._v(" "),a("p",[s._v("如果容器没有自动启动，可以手动启动它们。")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" start "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("container_name_or_id"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h3",{attrs:{id:"_10-检查日志-如果遇到问题"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_10-检查日志-如果遇到问题"}},[s._v("#")]),s._v(" 10. 检查日志（如果遇到问题）")]),s._v(" "),a("p",[s._v("如果遇到问题，可以查看Docker的日志文件以获取更多信息。")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" journalctl "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-u")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h3",{attrs:{id:"总结"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#总结"}},[s._v("#")]),s._v(" 总结")]),s._v(" "),a("ol",[a("li",[a("strong",[s._v("停止Docker服务")]),s._v("："),a("code",[s._v("sudo systemctl stop docker")])]),s._v(" "),a("li",[a("strong",[s._v("创建新的存储路径")]),s._v("："),a("code",[s._v("sudo mkdir -p /new/docker/storage")]),s._v(" 和 "),a("code",[s._v("sudo chown -R root:root /new/docker/storage")]),s._v(" 和 "),a("code",[s._v("sudo chmod -R 711 /new/docker/storage")])]),s._v(" "),a("li",[a("strong",[s._v("迁移现有数据")]),s._v("："),a("code",[s._v("sudo rsync -aqxP /var/lib/docker/ /new/docker/storage/")])]),s._v(" "),a("li",[a("strong",[s._v("修改Docker配置文件")]),s._v("：编辑或创建 "),a("code",[s._v("/etc/docker/daemon.json")]),s._v("，添加 "),a("code",[s._v('"data-root": "/new/docker/storage"')])]),s._v(" "),a("li",[a("strong",[s._v("重启Docker服务")]),s._v("："),a("code",[s._v("sudo systemctl start docker")])]),s._v(" "),a("li",[a("strong",[s._v("验证更改")]),s._v("："),a("code",[s._v("docker info | grep 'Docker Root Dir'")])]),s._v(" "),a("li",[a("strong",[s._v("检查镜像")]),s._v("："),a("code",[s._v("docker images")])]),s._v(" "),a("li",[a("strong",[s._v("检查容器")]),s._v("："),a("code",[s._v("docker ps -a")])]),s._v(" "),a("li",[a("strong",[s._v("重新启动容器")]),s._v("："),a("code",[s._v("docker start <container_name_or_id>")])]),s._v(" "),a("li",[a("strong",[s._v("检查日志")]),s._v("（如果遇到问题）："),a("code",[s._v("sudo journalctl -u docker")])])])])}),[],!1,null,null,null);a.default=r.exports}}]);