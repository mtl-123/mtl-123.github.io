---
title: Python uv 使用笔记
date: 2025-05-21 13:01:00
permalink: /pages/889785/
categories:
  - 《Python uv 使用笔记》
tags:
  -  uv
author:
  name: MeiChen
  link: https://github.com/mtl-123
---

# UV 简介

> UV 是基于 Rust 开发的高性能 Python 包/项目/环境管理工具，一站式替代 pip、pip-tools、poetry、pyenv、virtualenv 等工具，具备 10-100 倍于 pip 的速度，支持跨平台（macOS/Linux/Windows）。
> 官方文档：https://docs.astral.sh/uv/

## 一、安装 UV

### 1.1 快速安装

```bash
# Linux/macOS
curl -LsSf https://astral.sh/uv/install.sh | sh

# Windows (PowerShell)
powershell -c "irm https://astral.sh/uv/install.ps1 | iex"
```

### 1.2 其他安装方式

```bash
# 通过 pip 安装（兼容现有 Python 环境）
pip install uv --user

# 手动下载二进制包（GitHub Releases）
# 地址：https://github.com/astral-sh/uv/releases
```

### 1.3 验证安装

```bash
uv --version  # 输出版本号即安装成功
```

## 二、基础配置

### 2.1 国内镜像源配置（解决下载慢）

```bash
# 全局配置阿里云镜像（永久生效）
uv config set registry.index-url "https://mirrors.aliyun.com/pypi/simple/"
# 信任镜像源主机（可选）
uv config set registry.trusted-host "mirrors.aliyun.com"

# 查看配置
uv config show
```

### 2.2 Shell 自动补全

```bash
# Bash
echo 'eval "$(uv generate-shell-completion bash)"' >> ~/.bashrc && source ~/.bashrc

# Zsh
echo 'eval "$(uv generate-shell-completion zsh)"' >> ~/.zshrc && source ~/.zshrc

# Windows PowerShell
Add-Content -Path $PROFILE -Value '(& uv generate-shell-completion powershell) | Out-String | Invoke-Expression' && . $PROFILE
```

## 三、核心功能使用

### 3.1 Python 版本管理

```bash
# 列出可安装的 Python 版本
uv python list

# 安装指定 Python 版本
uv python install 3.11.9  # 精确版本
uv python install 3.10    # 最新补丁版

# 查看已安装的 Python 版本
uv python find

# 设置全局默认 Python 版本
uv python set-default 3.11.9

# 卸载 Python 版本
uv python uninstall 3.10
```

### 3.2 虚拟环境管理

```bash
# 创建虚拟环境（默认路径 ./venv）
uv venv
# 指定路径创建
uv venv ./my-venv
# 指定 Python 版本创建
uv venv --python 3.11.9

# 激活虚拟环境
# Linux/macOS
source .venv/bin/activate
# Windows (PowerShell)
. .venv/Scripts/Activate.ps1

# 退出虚拟环境
deactivate

# 查看虚拟环境信息
uv venv info
```

### 3.3 项目管理（核心）

#### 3.3.1 一键创建项目（指定 Python 版本）

```bash
# 最简版：创建项目 + 初始化配置 + 指定 Python 版本 + 自动创建虚拟环境
uv init my-project --python 3.11.9

# 进阶版：指定项目类型、作者、初始依赖
uv init my-project \
  --python 3.11.9 \
  --type application \  # 项目类型：library（默认）/application
  --author "Your Name <your@email.com>" \
  --dependency requests \  # 初始生产依赖
  --dev-dependency pytest  # 初始开发依赖
```

#### 3.3.2 依赖管理（项目内操作）

```bash
cd my-project  # 进入项目目录

# 添加依赖
uv add requests                # 生产依赖
uv add pytest --dev            # 开发依赖
uv add "requests>=2.31.0,<3.0" # 指定版本范围

# 移除依赖
uv remove requests
uv remove pytest --dev

# 更新依赖
uv update requests      # 更新指定依赖
uv update --all         # 更新所有依赖

# 同步依赖（按锁文件安装，多人协作/部署必备）
uv sync                 # 同步生产+开发依赖
uv sync --no-dev        # 仅同步生产依赖

# 生成/更新锁文件
uv lock

# 查看依赖树
uv tree                 # 完整依赖树
uv tree requests        # 仅查看指定依赖的树
```

#### 3.3.3 项目运行与构建

```bash
# 运行项目脚本
uv run main.py

# 运行测试（如 pytest）
uv run pytest

# 构建项目包（生成 wheel/sdist）
uv build

# 发布项目到 PyPI
uv publish
```

### 3.4 脚本模式（轻量级单文件运行）

```bash
# 运行独立脚本（自动处理依赖）
uv run my_script.py

# 为脚本添加依赖
uv add --script my_script.py requests

# 移除脚本依赖
uv remove --script my_script.py requests

# 查看脚本依赖
uv pip freeze --script my_script.py
```

### 3.5 Pip 兼容模式

```bash
# 直接替代 pip 使用
uv pip install requests
uv pip install -r requirements.txt
uv pip uninstall requests
uv pip list
uv pip show requests
```

## 四、高级配置（pyproject.toml 示例）

```toml
[project]
name = "my-project"
version = "0.1.0"
description = "UV 项目示例"
authors = ["Your Name <your@email.com>"]
requires-python = ">=3.11,<3.12"  # Python 版本约束
dependencies = [
  "requests>=2.31.0,<3.0"
]

[[tool.uv.index]]
name = "tuna"
url = "https://pypi.tuna.tsinghua.edu.cn/simple/"
```

## 五、卸载 UV

```bash
# Linux/macOS
rm -rf ~/.local/bin/uv ~/.local/bin/uvx ~/.cache/uv

# Windows (PowerShell)
Remove-Item -Recurse -Force $HOME\.local\bin\uv.exe
Remove-Item -Recurse -Force $HOME\.local\bin\uvx.exe
Remove-Item -Recurse -Force $HOME\.cache\uv
```

## 六、常用命令速查表

| 功能场景               | 核心命令                                    |
| ---------------------- | ------------------------------------------- | --- |
| 安装 UV                | `curl -LsSf https://astral.sh/uv/install.sh | sh` |
| 创建项目（指定Python） | `uv init 项目名 --python 3.11.9`            |
| 安装依赖               | `uv add 包名` / `uv add 包名 --dev`         |
| 同步依赖               | `uv sync`                                   |
| 运行脚本               | `uv run 脚本名.py`                          |
| 创建虚拟环境           | `uv venv`                                   |
| 查看 Python 版本       | `uv python list` / `uv python find`         |

### 总结

1. UV 核心优势是「一站式」和「高性能」，可替代多款 Python 管理工具，国内使用需先配置镜像源；
2. 一键创建项目的核心命令是 `uv init 项目名 --python 版本号`，可直接完成项目初始化+Python版本指定+虚拟环境创建；
3. 日常开发高频命令：`uv add/remove`（依赖管理）、`uv sync`（依赖同步）、`uv run`（运行脚本）、`uv venv`（虚拟环境）。
