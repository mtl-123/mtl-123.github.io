---
title: share_mount
date: 2025-05-23 01:07:26
permalink: /pages/bb8545/
categories:
  - shaer_mount
tags:
  - 
author: 
  name: MeiChen
  link: https://github.com/mtl-123
---


# åœ¨ Linux ä¸Šè¿œç¨‹æŒ‚è½½ Windows å…±äº«æ–‡ä»¶å¤¹ï¼ˆæ— åŠ å¯†ã€æ— éœ€æƒé™ï¼‰å®Œæ•´ç¬”è®°

---

## ä¸€ã€æ¦‚è¿°

æœ¬æ–‡æ¡£è¯¦ç»†è®°å½•åœ¨ **Linux ç³»ç»Ÿ** ä¸Šå¦‚ä½•è¿œç¨‹æŒ‚è½½ **Windows å…±äº«æ–‡ä»¶å¤¹**ï¼Œé€‚ç”¨äºå…±äº«è®¾ç½®ä¸º **æ— åŠ å¯†ã€æ— éœ€ç”¨æˆ·åå’Œå¯†ç å³å¯è®¿é—®** çš„åœºæ™¯ã€‚

æˆ‘ä»¬å°†æŒ‰ç…§ä»¥ä¸‹æµç¨‹è¿›è¡Œæ“ä½œï¼š

- å®‰è£…æ‰€éœ€è½¯ä»¶ï¼›
- é…ç½®ç½‘ç»œç¯å¢ƒï¼›
- å®é™…æŒ‚è½½æ“ä½œï¼›
- æµ‹è¯•æ˜¯å¦æˆåŠŸï¼›
- å‘½ä»¤æ³¨è§£è¯´æ˜ï¼›
- æ¡ˆä¾‹æ¼”ç¤ºï¼›
- å¼€æœºè‡ªåŠ¨æŒ‚è½½æ–¹æ³•ï¼ˆå»¶è¿ŸæŒ‚è½½ï¼‰ï¼›
- æ³¨æ„äº‹é¡¹ä¸æ’é”™å»ºè®®ã€‚

---

## äºŒã€å®‰è£…å¿…è¦è½¯ä»¶åŒ…

ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ ¹æ®ä½ çš„ Linux å‘è¡Œç‰ˆå®‰è£… `cifs-utils` å·¥å…·åŒ…ã€‚

<code-group>
  <code-block title="apt" active>

```bash
sudo apt update
sudo apt install cifs-utils
```

  </code-block>
  <code-block title="yum" active>

```bash
sudo yum install cifs-utils
```

  </code-block>
</code-group>

> âœ… **ä½œç”¨è¯´æ˜ï¼š**
>
> `cifs-utils` æ˜¯ç”¨äºæ”¯æŒ SMB/CIFS åè®®çš„å·¥å…·é›†ï¼Œå…è®¸ Linux æŒ‚è½½ Windows å…±äº«ç›®å½•ã€‚

---

## ä¸‰ã€é…ç½® Windows å…±äº«è·¯å¾„

ç¡®ä¿ Windows ä¸»æœºæ»¡è¶³ä»¥ä¸‹æ¡ä»¶ï¼š

- å·²å¯ç”¨æ–‡ä»¶å…±äº«åŠŸèƒ½ï¼›
- æ–‡ä»¶å¤¹å·²è®¾ç½®ä¸º Everyone å¯è¯»å†™ï¼›
- ä¸éœ€è¦ç”¨æˆ·åå’Œå¯†ç å³å¯è®¿é—®ï¼›
- åŒä¸€å±€åŸŸç½‘å†…å¯é€šä¿¡ï¼›
- é˜²ç«å¢™æœªé˜»æ­¢ SMB åè®®ï¼ˆé»˜è®¤ç«¯å£ TCP 445ï¼‰ã€‚

---

## å››ã€åˆ›å»ºæœ¬åœ°æŒ‚è½½ç‚¹

```bash
sudo mkdir -p /mnt/windows_share
```

> ğŸ“ ä½ å¯ä»¥å°† `/mnt/windows_share` æ›¿æ¢ä¸ºä½ å¸Œæœ›ä½¿ç”¨çš„ä»»æ„æŒ‚è½½è·¯å¾„ã€‚

---

## äº”ã€å®é™…æŒ‚è½½æ“ä½œ

### ä½¿ç”¨ `mount.cifs` å‘½ä»¤æŒ‚è½½

```bash
sudo mount.cifs //192.168.1.100/shared /mnt/windows_share -o guest,iocharset=utf8
```

> ğŸ” **å‘½ä»¤æ³¨è§£ï¼š**
>
> - `//192.168.1.100/shared`ï¼šWindows å…±äº«æ–‡ä»¶å¤¹è·¯å¾„ï¼›
> - `/mnt/windows_share`ï¼šLinux ä¸Šçš„æœ¬åœ°æŒ‚è½½ç‚¹ï¼›
> - `-o`ï¼šæŒ‡å®šæŒ‚è½½é€‰é¡¹ï¼›
>   - `guest`ï¼šè¡¨ç¤ºä»¥è®¿å®¢èº«ä»½è¿æ¥ï¼Œä¸éœ€è¦ç”¨æˆ·åå¯†ç ï¼›
>   - `iocharset=utf8`ï¼šå­—ç¬¦é›†æ”¯æŒï¼Œé˜²æ­¢ä¸­æ–‡ä¹±ç ã€‚

---

## å…­ã€æµ‹è¯•æŒ‚è½½æ˜¯å¦æˆåŠŸ

### æŸ¥çœ‹æŒ‚è½½ä¿¡æ¯

```bash
df -h | grep windows_share
```

### åˆ—å‡ºå…±äº«æ–‡ä»¶å†…å®¹

```bash
ls /mnt/windows_share
```

å¦‚æœèƒ½çœ‹åˆ° Windows å…±äº«ç›®å½•ä¸‹çš„æ–‡ä»¶ï¼Œåˆ™è¡¨ç¤ºæŒ‚è½½æˆåŠŸã€‚

---

## ä¸ƒã€å¸è½½æŒ‚è½½ç‚¹

å½“ä¸å†éœ€è¦æŒ‚è½½æ—¶ï¼Œå¯ä»¥æ‰§è¡Œä»¥ä¸‹å‘½ä»¤å¸è½½ï¼š

```bash
sudo umount /mnt/windows_share
```

---

## å…«ã€å¼€æœºè‡ªåŠ¨æŒ‚è½½ï¼ˆå»¶è¿ŸæŒ‚è½½æ¨èæ–¹å¼ï¼‰

ä¸ºäº†é¿å…ç³»ç»Ÿå¯åŠ¨æ—¶å› ç½‘ç»œæœåŠ¡æœªå°±ç»ªå¯¼è‡´æŒ‚è½½å¤±è´¥ï¼Œæˆ‘ä»¬é‡‡ç”¨ **Systemd + è„šæœ¬å»¶è¿ŸæŒ‚è½½** çš„æ–¹å¼ã€‚

### 1. åˆ›å»ºæŒ‚è½½è„šæœ¬

```bash
sudo nano /usr/local/bin/mount_windows_share.sh
```

å†™å…¥ä»¥ä¸‹å†…å®¹ï¼š

```bash
#!/bin/bash
sleep 10  # ç­‰å¾…ç½‘ç»œæœåŠ¡å¯åŠ¨å®Œæˆ
mount.cifs //192.168.1.100/shared /mnt/windows_share -o guest,iocharset=utf8
```

ä¿å­˜å¹¶èµ‹äºˆæ‰§è¡Œæƒé™ï¼š

```bash
sudo chmod +x /usr/local/bin/mount_windows_share.sh
```

### 2. åˆ›å»º Systemd æœåŠ¡

```bash
sudo nano /etc/systemd/system/mount-windows-share.service
```

å†™å…¥ä»¥ä¸‹å†…å®¹ï¼š

```ini
[Unit]
Description=Mount Windows Shared Folder
After=network.target

[Service]
Type=oneshot
ExecStart=/usr/local/bin/mount_windows_share.sh
RemainAfterExit=yes

[Install]
WantedBy=multi-user.target
```

å¯ç”¨æœåŠ¡ï¼š

```bash
sudo systemctl enable mount-windows-share.service
```

é‡å¯åç”Ÿæ•ˆï¼š

```bash
sudo reboot
```

---

## ä¹ã€å®Œæ•´æ¡ˆä¾‹æ¼”ç¤º

### åœºæ™¯æè¿°

- Windows IP åœ°å€ï¼š`192.168.1.100`
- å…±äº«æ–‡ä»¶å¤¹åï¼š`shared`
- Linux æŒ‚è½½è·¯å¾„ï¼š`/mnt/windows_share`
- ä¸éœ€è¦ç”¨æˆ·åå¯†ç è®¿é—®

### æ“ä½œæ­¥éª¤

```bash
# å®‰è£…ä¾èµ–
<code-group>
  <code-block title="apt" active>
    sudo apt install cifs-utils
  </code-block>
  <code-block title="yum" active>
    sudo yum install cifs-utils
  </code-block>
</code-group>

# åˆ›å»ºæŒ‚è½½ç‚¹
sudo mkdir -p /mnt/windows_share

# æ‰§è¡ŒæŒ‚è½½
sudo mount.cifs //192.168.1.100/shared /mnt/windows_share -o guest,iocharset=utf8

# æŸ¥çœ‹æ–‡ä»¶
ls /mnt/windows_share

# ç¼–å†™å»¶è¿ŸæŒ‚è½½è„šæœ¬
echo '#!/bin/bash
sleep 10
mount.cifs //192.168.1.100/shared /mnt/windows_share -o guest,iocharset=utf8' | sudo tee /usr/local/bin/mount_windows_share.sh
sudo chmod +x /usr/local/bin/mount_windows_share.sh

# åˆ›å»º systemd æœåŠ¡
echo '[Unit]
Description=Mount Windows Shared Folder
After=network.target

[Service]
Type=oneshot
ExecStart=/usr/local/bin/mount_windows_share.sh
RemainAfterExit=yes

[Install]
WantedBy=multi-user.target' | sudo tee /etc/systemd/system/mount-windows-share.service

# å¯ç”¨æœåŠ¡
sudo systemctl enable mount-windows-share.service

# é‡å¯ç³»ç»Ÿ
sudo reboot
```

---

## åã€æ³¨æ„äº‹é¡¹ä¸å¸¸è§é—®é¢˜

| é—®é¢˜ | è§£å†³æ–¹æ¡ˆ |
|------|-----------|
| `Host is down` | æ£€æŸ¥ç½‘ç»œè¿é€šæ€§ï¼Œç¡®è®¤ Windows æ˜¯å¦å¼€å¯å…±äº«æœåŠ¡ |
| `Permission denied` | ç¡®ä¿å…±äº«æ–‡ä»¶å¤¹å…è®¸ Everyone è®¿é—®ï¼Œå…³é—­å¯†ç ä¿æŠ¤å…±äº« |
| ä¸­æ–‡ä¹±ç  | æ·»åŠ  `iocharset=utf8` å‚æ•° |
| æŒ‚è½½å¤±è´¥ | å°è¯•ä½¿ç”¨ `mount.cifs` è€Œä¸æ˜¯ `mount -t cifs`ï¼Œé¿å…å‚æ•°å…¼å®¹æ€§é—®é¢˜ |

---

## åä¸€ã€æ€»ç»“

| æ­¥éª¤ | å†…å®¹ |
|------|------|
| 1 | å®‰è£… `cifs-utils`ï¼ˆæ”¯æŒ apt/yumï¼‰ |
| 2 | åˆ›å»ºæœ¬åœ°æŒ‚è½½ç›®å½• |
| 3 | ä½¿ç”¨ `mount.cifs` æŒ‚è½½å…±äº«ç›®å½• |
| 4 | æµ‹è¯•æ˜¯å¦æŒ‚è½½æˆåŠŸ |
| 5 | è®¾ç½®å»¶è¿Ÿå¼€æœºæŒ‚è½½ï¼ˆSystemd + è„šæœ¬ï¼‰ |
| 6 | æ³¨æ„äº‹é¡¹ä¸æ’é”™å»ºè®® |

---
