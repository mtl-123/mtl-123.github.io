---
title: network_configure
date: 2025-05-29 10:17:36
permalink: /pages/e61a28/
categories:
  - 系统
  - 系统
  - Linux
tags:
  - network_configure
author:
  name: MeiChen
  link: https://github.com/mtl-123
---


# 在无网络环境下安装 NetworkManager

---

## 准备工作

1. 系统版本：debian-12.10.0
2. 将刻录好的系统 ISO 镜像启动盘插入电脑
3. 执行以下命令查找 U 盘盘符：

   ```bash
   sudo fdisk -l
   ```

---

## 详细操作步骤

### 1. 挂载系统 ISO 镜像

### 找到iso镜像位置

```bash
root@m:~# lsblk  -l
NAME         MAJ:MIN RM  SIZE RO TYPE MOUNTPOINTS
sda            8:0    0   20G  0 disk
sda1           8:1    0  512M  0 part /boot/efi
sda2           8:2    0  488M  0 part /boot
sda3           8:3    0   19G  0 part
sr0           11:0    1  633M  0 rom # 镜像驱动名称 类型为 TYPE ：rom
m--vg-root   254:0    0   18G  0 lvm  /
m--vg-swap_1 254:1    0  976M  0 lvm  [SWAP]
```

```bash
# 创建挂载点目录
sudo mkdir -p /mnt/cdrom

# 挂载 ISO 镜像（需替换为实际路径）
root@m:~# mount /dev/sr0 /mnt/cdrom/
mount: /mnt/cdrom: WARNING: source write-protected, mounted read-only.

# 检查是否挂载成功
root@m:~# lsblk  -l
NAME         MAJ:MIN RM  SIZE RO TYPE MOUNTPOINTS
sda            8:0    0   20G  0 disk
sda1           8:1    0  512M  0 part /boot/efi
sda2           8:2    0  488M  0 part /boot
sda3           8:3    0   19G  0 part
sr0           11:0    1  633M  0 rom  /mnt/cdrom  # 这里已经挂载成功了
m--vg-root   254:0    0   18G  0 lvm  /
m--vg-swap_1 254:1    0  976M  0 lvm  [SWAP]

```

### 2. 配置本地软件源

```bash
# 使用  注册源 （关键步骤）：
# 配置本地源（以 debian-12.10.0 为例）
sudo tee /etc/apt/sources.list << 'EOF'
deb [trusted=yes] file:///mnt/cdrom bookworm main non-free-firmware
EOF
```

### 3. 更新软件包列表

```bash
root@m:/etc/apt# apt update
Get:1 file:/mnt/cdrom bookworm InRelease
Ign:1 file:/mnt/cdrom bookworm InRelease
Get:2 file:/mnt/cdrom bookworm Release [20.5 kB]
Get:2 file:/mnt/cdrom bookworm Release [20.5 kB]
Get:3 file:/mnt/cdrom bookworm Release.gpg
Ign:3 file:/mnt/cdrom bookworm Release.gpg
Reading package lists... Done
Building dependency tree... Done
Reading state information... Done
All packages are up to date.

```

### 4. 安装 NetworkManager

```bash
# 推荐安装方式（最小化依赖）
sudo apt-get install --no-install-recommends network-manager

# 完整安装（解决依赖问题时使用）
sudo apt-get install network-manager*
```

### 5. 启动并启用服务

```bash
sudo systemctl start NetworkManager
sudo systemctl enable NetworkManager
```

### 6. 使用 nmtui 配置网络

```bash
sudo nmtui
```

**操作指南**：

1. 选择 `Edit a connection`
2. 选择网络接口（如 `eth0`/`enp0s3`）
3. 配置 IPv4/IPv6：
   - 将 `Automatic` 改为 `Manual`
   - 添加 IP 地址、网关、DNS
4. 保存后选择 `Activate a connection` 重启连接

---

## 验证与恢复

### 1. 网络状态验证

```bash
ip addr show          # 检查 IP 分配
ping -c 4 8.8.8.8     # 测试外网连通性
```

### 2. 恢复原始源（可选）

```bash
sudo mv /etc/apt/sources.list.bak /etc/apt/sources.list
sudo umount /mnt/cdrom
sudo apt-get update
```

---

## 注意事项与扩展

### 关键注意事项

1. **版本一致性**：确保 ISO 镜像版本与系统一致（如 Ubuntu 20.04 对应 `focal`）
2. **依赖问题处理**：
   - 若遇依赖缺失，尝试完整安装 `network-manager*`
   - 手动下载依赖包：参考  的离线包安装方法
3. **服务器版适配**：

   ```bash
   sudo apt-get install network-manager-gnome  # 启用 GUI 组件
   ```

### 常用维护命令

```bash
sudo systemctl restart NetworkManager       # 重启服务
sudo systemctl status NetworkManager        # 检查状态
```

---

## 参考资料

- 离线安装包获取
- 手动下载依赖包方法
- NetworkManager 工具说明

> **最终提示**：通过 `nmtui` 文本界面可完全脱离图形环境完成配置，特别适合服务器场景使用。
