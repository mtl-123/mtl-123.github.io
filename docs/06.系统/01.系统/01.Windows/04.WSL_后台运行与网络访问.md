---
title: WSL_后台运行与网络访问
date: 2025-06-03 16:15:26
permalink: /pages/f6c3e3/
categories:
  - 系统
  - 系统
  - Windows
tags:
  - WSL_后台运行与网络访问
author:
  name: MeiChen
  link: https://github.com/mtl-123
---


# ⚙️ WSL 后台运行与网络访问配置指南

> 💡 本文档讲解如何让 WSL 在后台持续运行，并实现从局域网访问 WSL 内部服务。

---

## ⏳ 7. 保持 WSL 在后台持续运行

> 💡 当退出终端后，WSL 可能会自动关闭，导致 SSH 或其他服务中断。

### 解决方案：创建 `.vbs` 脚本开机启动 WSL 并保持运行

#### 1. 创建脚本文件 `start-wsl-background.vbs`

```vbs
Set objShell = CreateObject("WScript.Shell")
objShell.Run "cmd /c wsl", 0, False
```

#### 2. 设置开机自启动

- 按下 `Win + R` 输入 `shell:startup` 打开“启动”文件夹
- 将上述 `.vbs` 文件复制到该文件夹中

✅ 效果：

- Windows 开机后自动静默运行 WSL
- 即使关闭终端，WSL 也不会退出

---

## 🌐 8. 让宿主机及局域网访问 WSL 中的服务

> 💡 示例：你在 WSL 中运行了一个 Python HTTP 服务监听在 `8000` 端口，如何让局域网访问？

### 1. 在 WSL 中启动服务

```bash
nohup python3 -m http.server 8000 &
```

### 2. 获取 WSL 的 IP 地址

```bash
hostname -I
```

假设输出为：`172.27.250.42`

---

## 🔁 9. 配置 Windows 端口转发（Port Proxy）

### 1. 获取 WSL 网卡名称

在 PowerShell 中执行：

```powershell
ipconfig /all
```

找到类似如下信息：

```
以太网适配器 vEthernet (WSL (Hyper-V firewall)):

   IPv4 地址 . . . . . . . . . . . . : 172.27.240.1(首选)
```

### 2. 添加防火墙规则允许访问

管理员身份打开 PowerShell 并执行：

```powershell
New-NetFirewallRule -DisplayName "WSL" -Direction Inbound -InterfaceAlias "vEthernet (WSL (Hyper-V firewall))" -Action Allow
```

### 3. 配置端口转发（Port Proxy）

```powershell
netsh interface portproxy add v4tov4 listenaddress=0.0.0.0 listenport=8000 connectaddress=172.27.250.42 connectport=8000
```

---

## ✅ 10. 验证服务是否可达

### 在宿主机上测试本地访问

```bash
telnet 127.0.0.1 8000
```

### 在局域网设备上测试访问

```bash
telnet <Windows宿主机IP> 8000
```

例如：

```bash
telnet 192.168.10.10 8000
```

如果连接成功，说明服务已开放！

---

## 📎 附录：常用命令汇总

| 操作 | 命令 |
|------|------|
| 获取 WSL IP | `hostname -I` |
| 添加防火墙规则 | `New-NetFirewallRule -DisplayName "WSL" -Direction Inbound ...` |
| 配置端口转发 | `netsh interface portproxy add v4tov4 ...` |
| 测试端口连通性 | `telnet <IP> <Port>` |

---
